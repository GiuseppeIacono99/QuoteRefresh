ğŸ•¹ï¸ 5ï¸âƒ£ Come funziona

- Lanci lâ€™app (mvn exec:java o dalla tua IDE).

- Il bot parte e ogni minuto chiama QuoteFetcher.getQuotes()

- Se qualcuno ha scritto /start, il bot salva il suo chatId e gli manda i risultati periodicamente.

- Lâ€™utente puÃ² scrivere anche /quote per riceverli subito.

--


Perfetto ğŸ’ª ottima scelta â€” fare un bot Telegram in Java che recupera periodicamente le quote da un sito di scommesse Ã¨ assolutamente fattibile.

Ti spiego passo per passo come impostare il progetto completo in Java, con esempio di codice e librerie giuste ğŸ‘‡

ğŸ§° 1ï¸âƒ£ Dipendenze e librerie necessarie

Nel mondo Java, la libreria piÃ¹ comoda per creare bot Telegram Ã¨:
ğŸ‘‰ telegrambots

Per fare chiamate HTTP al sito di scommesse puoi usare:
ğŸ‘‰ OkHttp (o anche HttpClient di Java 11+)

Per lâ€™esecuzione periodica (ogni minuto) puoi usare:
ğŸ‘‰ ScheduledExecutorService

Esempio pom.xml (per Maven)
<dependencies>
    <dependency>
        <groupId>org.telegram</groupId>
        <artifactId>telegrambots</artifactId>
        <version>6.9.7</version>
    </dependency>

    <dependency>
        <groupId>com.squareup.okhttp3</groupId>
        <artifactId>okhttp</artifactId>
        <version>4.12.0</version>
    </dependency>
</dependencies>

ğŸ§  2ï¸âƒ£ Struttura del progetto
src/
 â””â”€â”€ main/java/
      â”œâ”€â”€ com/example/telegrambot/
      â”‚     â”œâ”€â”€ QuoteFetcher.java
      â”‚     â””â”€â”€ BettingBot.java
 â””â”€â”€ resources/
       â””â”€â”€ application.properties

âš™ï¸ 3ï¸âƒ£ QuoteFetcher.java â€” recupera le quote

Ecco un esempio semplice con OkHttp (puoi adattarlo allâ€™API reale o a scraping HTML).

package com.example.telegrambot;

import okhttp3.OkHttpClient;
import okhttp3.Request;
import okhttp3.Response;

public class QuoteFetcher {
    private static final OkHttpClient client = new OkHttpClient();

    public static String getQuotes() {
        try {
            String url = "https://esempio-scommesse.com/api/quote?match=juventus-inter";
            Request request = new Request.Builder()
                    .url(url)
                    .header("User-Agent", "QuoteBot/1.0")
                    .build();

            try (Response response = client.newCall(request).execute()) {
                if (!response.isSuccessful()) {
                    return "âŒ Errore HTTP: " + response.code();
                }

                String body = response.body().string();
                // Qui puoi fare parsing JSON se il sito restituisce quote in formato JSON
                return "ğŸ“Š Quote aggiornate: " + body;
            }
        } catch (Exception e) {
            return "âŒ Errore nel recupero quote: " + e.getMessage();
        }
    }
}

ğŸ¤– 4ï¸âƒ£ BettingBot.java â€” il bot Telegram
package com.example.telegrambot;

import org.telegram.telegrambots.bots.TelegramLongPollingBot;
import org.telegram.telegrambots.meta.TelegramBotsApi;
import org.telegram.telegrambots.meta.api.methods.send.SendMessage;
import org.telegram.telegrambots.meta.api.objects.Update;
import org.telegram.telegrambots.meta.exceptions.TelegramApiException;
import org.telegram.telegrambots.updatesreceivers.DefaultBotSession;

import java.util.concurrent.Executors;
import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.TimeUnit;

public class BettingBot extends TelegramLongPollingBot {
    private final String botUsername = "NOME_DEL_TUO_BOT";
    private final String botToken = "INSERISCI_IL_TUO_TOKEN_QUI";
    private Long chatIdUtente = null;  // salva chi ha fatto /start

    public static void main(String[] args) throws Exception {
        TelegramBotsApi botsApi = new TelegramBotsApi(DefaultBotSession.class);
        BettingBot bot = new BettingBot();
        botsApi.registerBot(bot);

        // Esegui ogni minuto
        ScheduledExecutorService scheduler = Executors.newSingleThreadScheduledExecutor();
        scheduler.scheduleAtFixedRate(() -> bot.inviaQuoteAutomatiche(), 0, 1, TimeUnit.MINUTES);
    }

    @Override
    public void onUpdateReceived(Update update) {
        if (update.hasMessage() && update.getMessage().hasText()) {
            String text = update.getMessage().getText();
            Long chatId = update.getMessage().getChatId();

            if (text.equals("/start")) {
                chatIdUtente = chatId;
                sendMessage(chatId, "ğŸ‘‹ Benvenuto! Ti invierÃ² le quote ogni minuto.");
            } else if (text.equals("/quote")) {
                sendMessage(chatId, QuoteFetcher.getQuotes());
            } else {
                sendMessage(chatId, "Scrivi /quote per vedere le quote o /start per iniziare.");
            }
        }
    }

    private void inviaQuoteAutomatiche() {
        if (chatIdUtente != null) {
            String quote = QuoteFetcher.getQuotes();
            sendMessage(chatIdUtente, quote);
        }
    }

    private void sendMessage(Long chatId, String text) {
        SendMessage message = new SendMessage();
        message.setChatId(chatId.toString());
        message.setText(text);
        try {
            execute(message);
        } catch (TelegramApiException e) {
            System.err.println("Errore invio messaggio: " + e.getMessage());
        }
    }

    @Override
    public String getBotUsername() {
        return botUsername;
    }

    @Override
    public String getBotToken() {
        return botToken;
    }
}